---
problem_id: 11365
title: Copying DNA
Algo/Data: []
Contest:
  - Nordic Collegiate Programming Contest
Contest_year: 2007
Contest_problem: D
solved: 0
---
# Reference

- https://onlinejudge.org/external/113/11365.pdf
- [vjudge](https://vjudge.net/problem/UVA-11365)

> This problem can not be solved greedily or with dynamic programming. You must test every order of building the parts of the target string. However, you can get a big speed-up from memorising the optimal answers to partial solutions, as many branches in the brute-force search will end up in the same state. Also, when trying to build a part of the target string starting at a given position, it will always pay off to build as large a portion of the string as possible.

\- Problem author: Nils Grimsmo

# 題解

比賽難題，全部用 AI 寫，這篇文章的目的是確保此題有正確答案。

## Claude 4.6 Sonnet


**1. Bitmask 基礎** 理解用一個整數的每個 bit 代表一個狀態（哪些位置已填好），會基本的位元操作：`&`, `|`, `<<`, `>>`, `(1 << n) - 1`。

**2. Memoization / Top-down DP** 知道 DFS + memo 的寫法，理解為什麼相同的 mask 不需要重算，這是這題從暴力搜索變成可行解的關鍵。

**3. 字串匹配** 知道怎麼找 substring（`string::find`），理解 forward 和 reverse 匹配的實作方式。

**4. 搜索思維（不是 greedy，不是 DP）** 這題最難的地方不是程式碼，而是**想到要窮舉所有填法順序**。很多人第一直覺會試 greedy（每次取最長）或 DP（1D 狀態），都是錯的。要能分析出「狀態」是「T 哪些位置已被覆蓋」。

**5. Precompute 的觀念** 知道把重複查詢的結果先算好存起來，避免在 DFS 裡重複做字串比較。

---

**學習路徑建議：** bitmask 入門題 → DFS+memo 入門題 → bitmask DP 題 → 才來挑戰這題

這題其實是競賽題中偏難的，能寫出來代表這幾個觀念都紮實了。

---

# I/O

## uDebug

### I

```
100
AGCGGGTCTTCTATAT
CACTGTGGGGCTAAAAGC
GAAGAAGAAACCCACACA
CCACA
ATC
TGAAA
CG
TACT
CTGTTTT
AGCGCATGCTCATCT
CCGGTCCCTTCCATCGG
CTAACGGCTCGTCCCG
TGGGGAAA
CGGGGCATGGTGTCCGA
ACGGT
GAC
AT
CTATTGT
CCACCCG
GGAGCGA
TTTTCATTAGACGAGAGT
AATCGCAAG
GGACCACAAGTGAAC
GCT
ACCTCGGGC
CTGCATCGGC
GAATTTCAATGACTGT
CAAGGACA
AAAGA
CCTGACT
GCGTTATTAGG
GTCCGAGAGCT
ACTTTTCTCTTTTA
CTGGTCCA
GTAACGGACTTAG
TAA
TCACCACT
GTTTGCTATC
AGCAAGTCTCCA
ACACACCAGTGAGCGT
GTTG
GAG
AGTTACCCCGG
CTTTGAAAAACCAGTG
TATCTCGGTAACGAG
GCTAA
TAGTATCACACTCTCAGG
AAATCGCCGAACTT
CTACTATAAGGCAAC
TGTCAGTTA
GGCTA
GGCTTTTAAGCT
A
ATTAACGACGAGC
TTCCG
AAAGTTA
TA
GCGGTTACCAACT
G
ATTGAGCCTGATAA
GG
GTTT
CAA
AAGTTTGC
AATGGCAGAA
AT
CGGGACCA
TCGGTTACAGTTC
CTGTAATCGATTTACC
TT
CACCCTAGGCCAGGG
AGGCACGTGGCTT
AAGCAACT
AGGTATAGTCCCA
CAATCACTA
TACTCTAG
TAAATTATTAGT
CGAATTGAGGGACTTCAT
CTCG
TCCTCTTTT
TG
CCGCCATGCCTTC
CACTAGA
CGAATG
GGTAAAA
TTGAGC
A
GAAG
CTTTGCGGCTCCTAAC
CTCAGTCCC
TT
TGTCTGTAATTCAT
GATTATTGCCA
ACGTGCTAGTAA
CGCA
ACGTAAGCA
TGCCCCCGCTTT
TTGAACAGTGTCACTCAA
CAGTGGGGCGACGCACTA
TCCGCTG
G
A
GCACACTAGAGT
CATGCTTAA
CTTACTGGAGCC
TCCAACGAGTTTC
TTTG
AAGCATCGTT
AA
AGAGCAGAGAA
CGACTCC
CATGCGGCGATTC
TCACGTAATAGAC
TAATTCCGAG
GACGAGCAGTTTGGTA
GCCTA
ATAAGGCGGTGTATGG
GAGCGAATGTTAGC
CAACAACTCTAGTG
GTTCAAAAACTTTTG
A
GATGTCCCACGTTACGT
CAGATCAAACC
TTGGC
TTGAAGAGCGCC
GTCTT
AGCGGGTTCGTTTGGGCG
TATCAACCATTA
TGCAGATCATACTG
GGTACGCCAGCGCTAAAT
GCA
GAGTCCCTGGAATCGGC
CTATTGCAGA
GATCAATTCGATGTGCGC
TACTGCCA
TCTGCGTCCC
CCTGTTTGACTCGCAGC
GCTTCCGTA
ATGCATCGATGGGCT
GTTCGCGCAGGCGC
CGGTGCTCG
AG
ATACAGGCCAGAGGGAT
AAACCGACAAA
TAATGGATATAT
TGGGC
GC
CCCCGAACAATGCT
GCACATCCTTAT
ACTAG
GCTATCTTGT
TTAGTGGGG
CGTACCGTA
AGACAACAATGTACAA
T
AAC
ACACGTG
GAACGCTCCT
GCTC
GTGGCG
AT
ATT
CAATGGTCGTAC
GT
GAG
TTGGGAAG
TAC
GAGCTGATGATCGCG
GAAA
TATTGGGCTTTAACGC
GCGCTTCGTC
GATCA
GTTATCTTT
GCCAAATCTGC
CT
CCTGACGG
T
TCCCGAAC
AAATCACTCCC
CTGTCCCGGA
GCGCCCAATGCC
CTAAGACCCGTCGCGTTC
TCG
ATC
CAGCGCCTGAGTCCTA
CATTCATTGC
GAGATTTACGATACTG
ACCTTTCGTTAGT
ACATCAGATTTCATCT
TTGCGTGCTGGTGGAG
ACATC
TT
A
CATAAAGAATGGG
CAATGTTGTGCATTC
CACGATATGTG
GTAGCTGAGGT
GA
CCCCAGGAA
TACCCTGT
```

### O

```
9
1
impossible
impossible
impossible
6
impossible
2
impossible
5
4
3
5
4
impossible
6
impossible
1
impossible
7
impossible
8
2
7
5
6
impossible
impossible
impossible
impossible
impossible
impossible
1
impossible
1
7
8
impossible
impossible
5
impossible
4
impossible
impossible
5
impossible
6
impossible
impossible
3
impossible
5
6
impossible
impossible
7
4
3
6
5
impossible
5
3
7
9
impossible
8
4
4
6
impossible
5
impossible
impossible
3
6
7
impossible
7
5
2
1
impossible
impossible
impossible
impossible
7
impossible
impossible
impossible
8
impossible
5
6
8
2
impossible
5
1
impossible
```

## Selection

我精挑細選的測資：

### I

```
3
TTTTCATTAGACGAGAGT
AATCGCAAG
TAGTATCACACTCTCAGG
AAATCGCCGAACTT
AAGCAACT
AGGTATAGTCCCA
```

### O

```
4
7
8
```