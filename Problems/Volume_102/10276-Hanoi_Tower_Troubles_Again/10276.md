---
problem_id: 10276
title: Hanoi Tower Troubles Again!
cpe_rank: 3
exam_dates: []
exam_numbers: []
topics:
  - Recurrence
solved: 1
created: 2026-01-01 20:34
last_modified: 2026-01-01 22:39
---
# Reference

- https://onlinejudge.org/external/102/10276.pdf
- https://www.udebug.com/UVa/10276

# 翻譯

## 題目

自從人們知道完成河內塔所需的步驟數量（可以用公式計算）之後，就不再需要實際動手一個一個搬移圓盤來測量了。但另一方面，他們並沒有停止思考與河內塔類似的謎題。S先生在此基礎上發明了一個小遊戲。

這個遊戲包含 N 根柱子和很多很多的球。這些球分別編號為 1, 2, 3...。這些球看起來很普通，但實際上它們是魔法球。**如果兩個球上數字的和不是完全平方數，當它們靠得太近時，它們會以巨大的力量互相排斥，因此它們永遠不能被放在一起接觸彼此。**

玩家每次必須將一個球放在某根柱子的頂端。他必須先嘗試放置球 1，然後是球 2，接著是球 3... 依此類推。**如果他無法放置某個球，遊戲就結束。** 請幫助玩家盡可能放置最多的球。

你可以參考上面的圖片，它展示了 4 根柱子的最佳結果。

## 輸入

- 第一行包含一個整數 T，表示測試案例的數量（1 ≤ T ≤ 50）
- 每個測試案例包含一個整數 N（1 ≤ N ≤ 50），表示可用的柱子數量

## 輸出

對於每個測試案例，輸出一行包含一個整數，表示可以放置的球的最大數量。如果可以放置無限多個球，則輸出 '-1'。

# 題解

作圖如下，會發現：

![](https://github.com/bluesquid29/UVA-C-Cpp/blob/main/Problems/Volume_102/10276-Hanoi_Tower_Troubles_Again!/10276.png?raw=true)

因此遞迴公式：

$$a_n = a_{n-1} + n + (n \pmod 2)$$

每一項會分別相差：

$$
2, 2, 4, 4, 6, 6, 8, 8, \dots
$$

用 iteration 解決

# I/O (uDebug)

## Input

```
50
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
```

## Output

```
1
3
7
11
17
23
31
39
49
59
71
83
97
111
127
143
161
179
199
219
241
263
287
311
337
363
391
419
449
479
511
543
577
611
647
683
721
759
799
839
881
923
967
1011
1057
1103
1151
1199
1249
1299
```