# 302 - John's trip

Little Johnny has got a new car. He decided to drive around the town to visit his friends. Johnny wanted to visit all his friends, but there was many of them. In each street he had one friend. He started thinking how to make his trip as short as possible. Very soon he realized that the best way to do it was to travel through each street of town only once. Naturally, he wanted to finish his trip at the same place he started, at his parents' house.

The streets in Johnny’s town were named by integer numbers from 1 to $n$, $n < 1995$. The junctions were independently named by integer numbers from 1 to $m$, $m \le 44$. All junctions in the town had different numbers. Each street was connecting exactly two (not necessarily different) junctions. No two streets in the town had the same number. He immediately started to plan his round trip. If there was more than one such round trip, he would have chosen the one which, when written down as a sequence of street numbers is lexicographically the smallest. But Johnny was not able to find even one such round trip.

Help Johnny and write a program which finds the desired shortest round trip. If the round trip does not exist the program should write a message. Assume that Johnny lives at the junction ending the 1st street input with smaller number. All streets in the town are two way. There exists a way from each street to another street in the town. The streets in the town are very narrow and there is no possibility to turn back the car once he is in the street.

## Input

Input file consists of several blocks. Each block describes one town. Each line in the block contains three integers $x, y, z$, where $x > 0$ and $y > 0$ are the numbers of junctions which are connected by the street number $z$. The end of the block is marked by the line containing $x = y = 0$. At the end of the input file there is an empty block, $x = y = 0$.

## Output

The output file consists of 2 line blocks corresponding to the blocks of the input file. The first line of each block contains the sequence of street numbers (single members of the sequence are separated by space) describing Johnny’s round trip. If the round trip cannot be found the corresponding output block contains the message `Round trip does not exist.`. The second line of each block is empty.

## Sample Input

```
1 2 1
2 3 2
3 1 6
1 2 5
2 3 3
3 1 4
0 0
1 2 1
2 3 2
1 3 3
2 4 4
0 0
0 0
```

## Sample Output

```
1 2 3 5 4 6

Round trip does not exist.
```

---

# 中文翻譯

小強尼買了一輛新車。他決定開車繞城拜訪他的朋友。強尼想拜訪所有朋友，但朋友實在太多了。每一條街上都有一位朋友。他開始思考如何讓旅程儘量縮短。很快他發現，最佳的方法是每一條街只走一次。當然，他希望最後能回到出發的地方，也就是他父母的家。

強尼城鎮中的街道以整數 1 到 $n$ 命名，且 $n < 1995$。路口則以整數 1 到 $m$ 命名，且 $m \le 44$。城鎮中所有路口的編號皆不相同。每條街恰好連接兩個（不一定不同的）路口。城鎮中沒有任何兩條街具有相同的編號。他立刻開始規劃他的環狀旅程。若存在多條這樣的環狀旅程，他會選擇將街道編號寫成序列後，字典序最小的那一條。但強尼卻連一條可行的環狀旅程都找不到。

請幫助強尼撰寫一個程式，找出所需的最短環狀旅程。若環狀旅程不存在，程式應輸出一則訊息。假設強尼住在第一條輸入街道中，編號較小的那個端點路口。城鎮中的所有街道皆為雙向。從任意一條街道都存在一條路可以到達城鎮中的其他街道。街道非常狹窄，一旦進入街道便無法中途迴轉。


## 輸入

輸入檔包含多個區塊。每個區塊描述一個城鎮。區塊中的每一行包含三個整數 $x, y, z$，其中 $x > 0$ 與 $y > 0$ 為由街道編號 $z$ 所連接的兩個路口編號。當出現 $x = y = 0$ 的那一行時，代表該區塊結束。整個輸入檔的最後會再出現一個空的區塊，即 $x = y = 0$。

## 輸出

輸出檔由多個兩行的區塊組成，對應於輸入檔中的每個區塊。每個區塊的第一行輸出描述強尼環狀旅程的街道編號序列（各街道編號以空白分隔）。若無法找到環狀旅程，則輸出該區塊的訊息 `Round trip does not exist.`。每個區塊的第二行為空行。